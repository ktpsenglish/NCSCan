<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âª£Êù±Ë©±Ë∂£Âë≥Â≠∏Â†Ç | Cantonese Fun Learning</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Custom animations not in Tailwind default */
        @keyframes bounce-slow {
            0%, 100% { transform: translateY(-5%); }
            50% { transform: translateY(5%); }
        }
        .animate-bounce-slow {
            animation: bounce-slow 3s infinite;
        }
        .text-shadow-sm {
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .stroke-text {
            -webkit-text-stroke: 2px #4f46e5; /* Indigo-600 */
            color: white;
        }
        /* Hide scrollbar for cleaner look */
        body::-webkit-scrollbar {
            width: 0.5em;
        }
        body::-webkit-scrollbar-track {
            box-shadow: inset 0 0 6px rgba(0,0,0,0.1);
        }
        body::-webkit-scrollbar-thumb {
            background-color: darkgrey;
            outline: 1px solid slategrey;
            border-radius: 10px;
        }
        .font-urdu {
            font-family: 'Noto Nastaliq Urdu', serif;
        }
    </style>
    <!-- Add Noto Nastaliq Urdu for better Urdu rendering -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        // --- Globals ---
        const { useState, useEffect, useRef } = React;

        // --- Icons (Inline SVG to avoid CDN dependency issues) ---
        const Icon = ({ children, size = 24, className = "", ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className} 
                {...props}
            >
                {children}
            </svg>
        );

        const Volume2 = (props) => <Icon {...props}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" /><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07" /></Icon>;
        const Mic = (props) => <Icon {...props}><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></Icon>;
        const ArrowLeft = (props) => <Icon {...props}><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></Icon>;
        const Star = (props) => <Icon {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></Icon>;
        const Play = (props) => <Icon {...props}><polygon points="5 3 19 12 5 21 5 3"/></Icon>;
        const CheckCircle = (props) => <Icon {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></Icon>;
        const XCircle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></Icon>;
        const Trophy = (props) => <Icon {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></Icon>;
        const Home = (props) => <Icon {...props}><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></Icon>;
        const BookOpen = (props) => <Icon {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></Icon>;
        const Brain = (props) => <Icon {...props}><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></Icon>;
        const Sparkles = (props) => <Icon {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 5H5"/><path d="M19 15v4"/><path d="M15 17h4"/></Icon>;
        const Smile = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></Icon>;
        const MessageCircle = (props) => <Icon {...props}><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></Icon>;
        const FileText = (props) => <Icon {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></Icon>;
        const Music = (props) => <Icon {...props}><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></Icon>;
        const VolumeX = (props) => <Icon {...props}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></Icon>;

        // --- Êï∏ÊìöË≥áÊñôÂ∫´ (Vocabulary Data) ---
        const vocabData = [
          {
            id: 'greetings',
            title: 'Êó•Â∏∏Á¶ÆË≤å',
            titleEng: 'Greetings',
            emoji: 'üëã',
            theme: 'bg-yellow-400', 
            words: [
              { id: '1-1', term: '‰Ω†Â•Ω', written: '‰Ω†Â•Ω', jyutping: 'nei5 hou2', eng: 'Hello', urdu: '€Å€åŸÑŸà', viet: 'Xin ch√†o', emoji: 'üëã' },
              { id: '1-2', term: 'Êó©Êô®', written: 'Êó©ÂÆâ', jyutping: 'zou2 san4', eng: 'Good Morning', urdu: 'ÿµÿ®ÿ≠ ÿ®ÿÆ€åÿ±', viet: 'Ch√†o bu·ªïi s√°ng', emoji: 'üåÖ' },
              { id: '1-3', term: 'ÂçàÂÆâ', written: 'ÂçàÂÆâ', jyutping: 'ng5 on1', eng: 'Good Afternoon', urdu: 'ÿØŸàŸæ€Åÿ± ÿ®ÿÆ€åÿ±', viet: 'Ch√†o bu·ªïi chi·ªÅu', emoji: '‚òÄÔ∏è' },
              { id: '1-4', term: 'Êôö‰∏äÂ•Ω', written: 'Êôö‰∏äÂ•Ω', jyutping: 'maan5 soeng6 hou2', eng: 'Good Evening', urdu: 'ÿ¥ÿßŸÖ ÿ®ÿÆ€åÿ±', viet: 'Ch√†o bu·ªïi t·ªëi', emoji: 'üåô' },
              { id: '1-5', term: 'Â§öË¨ù', written: 'Ë¨ùË¨ù', jyutping: 'do1 ze6', eng: 'Thank you (gift)', urdu: 'ÿ¥⁄©ÿ±€å€Å', viet: 'C·∫£m ∆°n (qu√†)', emoji: 'üéÅ' },
              { id: '1-6', term: 'ÂîîË©≤', written: 'Ë¨ùË¨ù / ÂãûÈßï', jyutping: 'm4 goi1', eng: 'Thank you / Please', urdu: 'ÿ¥⁄©ÿ±€å€Å / ÿ®ÿ±ÿß€Å ⁄©ÿ±ŸÖ', viet: 'C·∫£m ∆°n / L√†m ∆°n', emoji: 'üôè' },
              { id: '1-7', term: 'ÂÜçË¶ã', written: 'ÂÜçË¶ã', jyutping: 'zoi3 gin3', eng: 'Goodbye', urdu: 'ÿÆÿØÿß ÿ≠ÿßŸÅÿ∏', viet: 'T·∫°m bi·ªát', emoji: 'üëã' },
            ]
          },
          {
            id: 'school_people',
            title: 'Ê†°Âúí‰∫∫Áâ©',
            titleEng: 'People at School',
            emoji: 'üë®‚Äçüè´',
            theme: 'bg-blue-400',
            words: [
              { id: '2-1-2', term: 'Ê†°Èï∑', written: 'Ê†°Èï∑', jyutping: 'haau6 zoeng2', eng: 'Principal', urdu: 'Ÿæÿ±ŸÜÿ≥ŸæŸÑ', viet: 'Hi·ªáu tr∆∞·ªüng', emoji: 'üë®‚Äçüè´' },
              { id: '2-1-3', term: 'ËÄÅÂ∏´', written: 'ËÄÅÂ∏´', jyutping: 'lou5 si1', eng: 'Teacher', urdu: 'ÿßÿ≥ÿ™ÿßÿØ', viet: 'Gi√°o vi√™n', emoji: 'üë©‚Äçüè´' },
              { id: '2-1-4', term: 'ÂêåÂ≠∏', written: 'ÂêåÂ≠∏', jyutping: 'tung4 hok6', eng: 'Classmate', urdu: '€ÅŸÖ ÿ¨ŸÖÿßÿπÿ™', viet: 'B·∫°n h·ªçc', emoji: 'üë´' },
              { id: '2-1-5', term: 'Â∑•Âèã', written: 'Ê†°Â∑•', jyutping: 'gung1 jau5', eng: 'Janitor', urdu: 'ÿßÿ≥⁄©ŸàŸÑ ⁄©ÿß ŸÖŸÑÿßÿ≤ŸÖ', viet: 'Nh√¢n vi√™n t·∫°p v·ª•', emoji: 'üßπ' },
            ]
          },
          {
            id: 'school_facilities',
            title: 'Ê†°ÂúíË®≠ÊñΩ',
            titleEng: 'School Facilities',
            emoji: 'üè´',
            theme: 'bg-indigo-400',
            words: [
              { id: '2-1-1', term: 'Â≠∏Ê†°', written: 'Â≠∏Ê†°', jyutping: 'hok6 haau6', eng: 'School', urdu: 'ÿßÿ≥⁄©ŸàŸÑ', viet: 'Tr∆∞·ªùng h·ªçc', emoji: 'üè´' },
              { id: '2-2-1', term: 'Ë™≤ÂÆ§', written: 'ÊïôÂÆ§', jyutping: 'fo3 sat1', eng: 'Classroom', urdu: '⁄©ŸÑÿßÿ≥ ÿ±ŸàŸÖ', viet: 'Ph√≤ng h·ªçc', emoji: 'ü™ë' },
              { id: '2-2-2', term: 'ÊìçÂ†¥', written: 'ÊìçÂ†¥', jyutping: 'cou1 coeng4', eng: 'Playground', urdu: '⁄©⁄æ€åŸÑ ⁄©ÿß ŸÖ€åÿØÿßŸÜ', viet: 'S√¢n ch∆°i', emoji: 'üèÉ' },
              { id: '2-2-3', term: 'Á¶ÆÂ†Ç', written: 'Á¶ÆÂ†Ç', jyutping: 'lai5 tong4', eng: 'Hall', urdu: '€ÅÿßŸÑ', viet: 'H·ªôi tr∆∞·ªùng', emoji: 'üèüÔ∏è' },
              { id: '2-2-4', term: 'Ê®ìÊ¢Ø', written: 'Ê®ìÊ¢Ø', jyutping: 'lau4 tai1', eng: 'Stairs', urdu: 'ÿ≥€å⁄ë⁄æ€åÿß⁄∫', viet: 'C·∫ßu thang', emoji: 'ü™ú' },
              { 
                id: '2-2-5', 
                term: 'Ëµ∞Âªä', 
                written: 'Ëµ∞Âªä', 
                jyutping: 'zau2 long2', 
                eng: 'Corridor', 
                urdu: 'ÿ®ÿ±ÿ¢ŸÖÿØ€Å', 
                viet: 'H√†nh lang', 
                emoji: 'üè´',
                image: 'https://images.unsplash.com/photo-1596495578065-6e076cf13431?auto=format&fit=crop&w=600&q=80' 
              },
            ]
          },
          {
            id: 'numbers',
            title: 'Êï∏Â≠ó',
            titleEng: 'Numbers',
            emoji: 'üî¢',
            theme: 'bg-green-400',
            words: [
              { id: '3-1', term: '‰∏Ä', written: '‰∏Ä', jyutping: 'jat1', eng: 'One', urdu: 'ÿß€å⁄©', viet: 'M·ªôt', emoji: '1Ô∏è‚É£' },
              { id: '3-2', term: '‰∫å', written: '‰∫å', jyutping: 'ji6', eng: 'Two', urdu: 'ÿØŸà', viet: 'Hai', emoji: '2Ô∏è‚É£' },
              { id: '3-3', term: '‰∏â', written: '‰∏â', jyutping: 'saam1', eng: 'Three', urdu: 'ÿ™€åŸÜ', viet: 'Ba', emoji: '3Ô∏è‚É£' },
              { id: '3-4', term: 'Âõõ', written: 'Âõõ', jyutping: 'sei3', eng: 'Four', urdu: '⁄Üÿßÿ±', viet: 'B·ªën', emoji: '4Ô∏è‚É£' },
              { id: '3-5', term: '‰∫î', written: '‰∫î', jyutping: 'ng5', eng: 'Five', urdu: 'ŸæÿßŸÜ⁄Ü', viet: 'NƒÉm', emoji: '5Ô∏è‚É£' },
              { id: '3-6', term: 'ÂÖ≠', written: 'ÂÖ≠', jyutping: 'luk6', eng: 'Six', urdu: '⁄Ü⁄æ', viet: 'S√°u', emoji: '6Ô∏è‚É£' },
              { id: '3-7', term: '‰∏É', written: '‰∏É', jyutping: 'cat1', eng: 'Seven', urdu: 'ÿ≥ÿßÿ™', viet: 'B·∫£y', emoji: '7Ô∏è‚É£' },
              { id: '3-8', term: 'ÂÖ´', written: 'ÂÖ´', jyutping: 'baat3', eng: 'Eight', urdu: 'ÿ¢Ÿπ⁄æ', viet: 'T√°m', emoji: '8Ô∏è‚É£' },
              { id: '3-9', term: '‰πù', written: '‰πù', jyutping: 'gau2', eng: 'Nine', urdu: 'ŸÜŸà', viet: 'Ch√≠n', emoji: '9Ô∏è‚É£' },
              { id: '3-10', term: 'ÂçÅ', written: 'ÂçÅ', jyutping: 'sap6', eng: 'Ten', urdu: 'ÿØÿ≥', viet: 'M∆∞·ªùi', emoji: 'üîü' },
              { id: '3-11', term: 'Áôæ', written: 'Áôæ', jyutping: 'baak3', eng: 'Hundred', urdu: 'ÿ≥Ÿà', viet: 'TrƒÉm', emoji: 'üíØ' },
              { id: '3-12', term: 'ÂçÉ', written: 'ÂçÉ', jyutping: 'cin1', eng: 'Thousand', urdu: '€Åÿ≤ÿßÿ±', viet: 'Ngh√¨n', emoji: 'k' },
            ]
          },
          {
            id: 'datetime',
            title: 'Êúà‰ªΩÂíåÊó•Â≠ê',
            titleEng: 'Months & Days',
            emoji: 'üìÖ',
            theme: 'bg-orange-400',
            words: [
              { id: '4-1', term: '‰∏ÄÊúà', written: '‰∏ÄÊúà', jyutping: 'jat1 jyut6', eng: 'January', urdu: 'ÿ¨ŸÜŸàÿ±€å', viet: 'Th√°ng m·ªôt', emoji: 'üéÜ' },
              { id: '4-2', term: '‰∫åÊúà', written: '‰∫åÊúà', jyutping: 'ji6 jyut6', eng: 'February', urdu: 'ŸÅÿ±Ÿàÿ±€å', viet: 'Th√°ng hai', emoji: 'üßß' },
              { id: '4-3', term: '‰∏âÊúà', written: '‰∏âÊúà', jyutping: 'saam1 jyut6', eng: 'March', urdu: 'ŸÖÿßÿ±⁄Ü', viet: 'Th√°ng ba', emoji: 'üå±' },
              { id: '4-4', term: 'ÂõõÊúà', written: 'ÂõõÊúà', jyutping: 'sei3 jyut6', eng: 'April', urdu: 'ÿßŸæÿ±€åŸÑ', viet: 'Th√°ng t∆∞', emoji: 'üêá' },
              { id: '4-5', term: '‰∫îÊúà', written: '‰∫îÊúà', jyutping: 'ng5 jyut6', eng: 'May', urdu: 'ŸÖÿ¶€å', viet: 'Th√°ng nƒÉm', emoji: 'üíê' },
              { id: '4-6', term: 'ÂÖ≠Êúà', written: 'ÂÖ≠Êúà', jyutping: 'luk6 jyut6', eng: 'June', urdu: 'ÿ¨ŸàŸÜ', viet: 'Th√°ng s√°u', emoji: '‚òÄÔ∏è' },
              { id: '4-7', term: '‰∏ÉÊúà', written: '‰∏ÉÊúà', jyutping: 'cat1 jyut6', eng: 'July', urdu: 'ÿ¨ŸàŸÑÿßÿ¶€å', viet: 'Th√°ng b·∫£y', emoji: 'üç¶' },
              { id: '4-8', term: 'ÂÖ´Êúà', written: 'ÂÖ´Êúà', jyutping: 'baat3 jyut6', eng: 'August', urdu: 'ÿß⁄Øÿ≥ÿ™', viet: 'Th√°ng t√°m', emoji: 'üèñÔ∏è' },
              { id: '4-9', term: '‰πùÊúà', written: '‰πùÊúà', jyutping: 'gau2 jyut6', eng: 'September', urdu: 'ÿ≥ÿ™ŸÖÿ®ÿ±', viet: 'Th√°ng ch√≠n', emoji: 'üéí' },
              { id: '4-10', term: 'ÂçÅÊúà', written: 'ÂçÅÊúà', jyutping: 'sap6 jyut6', eng: 'October', urdu: 'ÿß⁄©ÿ™Ÿàÿ®ÿ±', viet: 'Th√°ng m∆∞·ªùi', emoji: 'üéÉ' },
              { id: '4-11', term: 'ÂçÅ‰∏ÄÊúà', written: 'ÂçÅ‰∏ÄÊúà', jyutping: 'sap6 jat1 jyut6', eng: 'November', urdu: 'ŸÜŸàŸÖÿ®ÿ±', viet: 'Th√°ng m∆∞·ªùi m·ªôt', emoji: 'üçÇ' },
              { id: '4-12', term: 'ÂçÅ‰∫åÊúà', written: 'ÂçÅ‰∫åÊúà', jyutping: 'sap6 ji6 jyut6', eng: 'December', urdu: 'ÿØÿ≥ŸÖÿ®ÿ±', viet: 'Th√°ng m∆∞·ªùi hai', emoji: 'üéÑ' },
              { id: '4-13', term: 'ÊòüÊúüÊó•', written: 'ÊòüÊúüÊó•', jyutping: 'sing1 kei4 jat6', eng: 'Sunday', urdu: 'ÿßÿ™Ÿàÿßÿ±', viet: 'Ch·ªß nh·∫≠t', emoji: 'üåû' },
              { id: '4-14', term: 'ÊòüÊúü‰∏Ä', written: 'ÊòüÊúü‰∏Ä', jyutping: 'sing1 kei4 jat1', eng: 'Monday', urdu: 'Ÿæ€åÿ±', viet: 'Th·ª© hai', emoji: '1Ô∏è‚É£' },
              { id: '4-15', term: 'ÊòüÊúü‰∫å', written: 'ÊòüÊúü‰∫å', jyutping: 'sing1 kei4 ji6', eng: 'Tuesday', urdu: 'ŸÖŸÜ⁄ØŸÑ', viet: 'Th·ª© ba', emoji: '2Ô∏è‚É£' },
              { id: '4-16', term: 'ÊòüÊúü‰∏â', written: 'ÊòüÊúü‰∏â', jyutping: 'sing1 kei4 saam1', eng: 'Wednesday', urdu: 'ÿ®ÿØ⁄æ', viet: 'Th·ª© t∆∞', emoji: '3Ô∏è‚É£' },
              { id: '4-17', term: 'ÊòüÊúüÂõõ', written: 'ÊòüÊúüÂõõ', jyutping: 'sing1 kei4 sei3', eng: 'Thursday', urdu: 'ÿ¨ŸÖÿπÿ±ÿßÿ™', viet: 'Th·ª© nƒÉm', emoji: '4Ô∏è‚É£' },
              { id: '4-18', term: 'ÊòüÊúü‰∫î', written: 'ÊòüÊúü‰∫î', jyutping: 'sing1 kei4 ng5', eng: 'Friday', urdu: 'ÿ¨ŸÖÿπ€Å', viet: 'Th·ª© s√°u', emoji: '5Ô∏è‚É£' },
              { id: '4-19', term: 'ÊòüÊúüÂÖ≠', written: 'ÊòüÊúüÂÖ≠', jyutping: 'sing1 kei4 luk6', eng: 'Saturday', urdu: '€ÅŸÅÿ™€Å', viet: 'Th·ª© b·∫£y', emoji: '6Ô∏è‚É£' },
            ]
          },
          {
            id: 'time',
            title: 'ÊôÇÈñì',
            titleEng: 'Time',
            emoji: '‚è∞',
            theme: 'bg-red-400',
            words: [
              { id: '5-1', term: 'Êó©‰∏ä', written: 'Êó©‰∏ä', jyutping: 'zou2 soeng6', eng: 'Morning', urdu: 'ÿµÿ®ÿ≠', viet: 'Bu·ªïi s√°ng', emoji: 'üåÖ' },
              { id: '5-2', term: '‰∏≠Âçà', written: '‰∏≠Âçà', jyutping: 'zung1 ng5', eng: 'Noon', urdu: 'ÿØŸàŸæ€Åÿ±', viet: 'Bu·ªïi tr∆∞a', emoji: '‚òÄÔ∏è' },
              { id: '5-3', term: '‰∏ãÂçà', written: '‰∏ãÂçà', jyutping: 'haa6 ng5', eng: 'Afternoon', urdu: 'ÿ≥€Å Ÿæ€Åÿ±', viet: 'Bu·ªïi chi·ªÅu', emoji: 'üå§Ô∏è' },
              { id: '5-4', term: 'Êôö‰∏ä', written: 'Êôö‰∏ä', jyutping: 'maan5 soeng6', eng: 'Night', urdu: 'ÿ±ÿßÿ™', viet: 'Bu·ªïi t·ªëi', emoji: 'üåô' },
              { id: '5-5', term: 'ÊôÇ', written: 'Â∞èÊôÇ', jyutping: 'si4', eng: 'Hour', urdu: '⁄Ø⁄æŸÜŸπ€Å', viet: 'Gi·ªù', emoji: '‚è≥' },
              { id: '5-6', term: 'ÂàÜ', written: 'ÂàÜÈêò', jyutping: 'fan1', eng: 'Minute', urdu: 'ŸÖŸÜŸπ', viet: 'Ph√∫t', emoji: '‚è±Ô∏è' },
            ]
          },
          {
            id: 'emotions',
            title: 'ÊÉÖÁ∑íÂñúÂ•Ω',
            titleEng: 'Emotions',
            emoji: 'üòä',
            theme: 'bg-pink-400',
            words: [
              { id: '6-1', term: 'ÈñãÂøÉ', written: 'Âø´Ê®Ç', jyutping: 'hoi1 sam1', eng: 'Happy', urdu: 'ÿÆŸàÿ¥', viet: 'Vui v·∫ª', emoji: 'üòÑ' },
              { id: '6-2', term: 'È´òËàà', written: 'È´òËàà', jyutping: 'gou1 hing3', eng: 'Glad', urdu: 'ÿÆŸàÿ¥', viet: 'H√¢n hoan', emoji: 'üòÜ' },
              { id: '6-3', term: 'ÂÇ∑ÂøÉ', written: 'Èõ£ÈÅé', jyutping: 'soeng1 sam1', eng: 'Sad', urdu: 'ÿßÿØÿßÿ≥', viet: 'Bu·ªìn', emoji: 'üò¢' },
              { id: '6-4', term: 'ÁîüÊ∞£', written: 'ÊÜ§ÊÄí', jyutping: 'saang1 hei3', eng: 'Angry', urdu: 'ŸÜÿßÿ±ÿßÿ∂', viet: 'T·ª©c gi·∫≠n', emoji: 'üò°' },
              { id: '6-5', term: 'È©ö', written: 'ÂÆ≥ÊÄï', jyutping: 'geng1', eng: 'Scared', urdu: 'ÿÆŸàŸÅÿ≤ÿØ€Å', viet: 'S·ª£ h√£i', emoji: 'üò±' },
              { id: '6-6', term: 'ÈêòÊÑè', written: 'ÂñúÊ≠°', jyutping: 'zung1 ji3', eng: 'Like', urdu: 'Ÿæÿ≥ŸÜÿØ', viet: 'Th√≠ch', emoji: '‚ù§Ô∏è' },
            ]
          },
          {
            id: 'colors',
            title: 'È°èËâ≤',
            titleEng: 'Colours',
            emoji: 'üé®',
            theme: 'bg-purple-400',
            words: [
              { id: '7-1', term: 'Á¥ÖËâ≤', written: 'Á¥ÖËâ≤', jyutping: 'hung4 sik1', eng: 'Red', urdu: 'ÿ≥ÿ±ÿÆ', viet: 'M√†u ƒë·ªè', emoji: 'üî¥' },
              { id: '7-2', term: 'ËóçËâ≤', written: 'ËóçËâ≤', jyutping: 'laam4 sik1', eng: 'Blue', urdu: 'ŸÜ€åŸÑÿß', viet: 'M√†u xanh d∆∞∆°ng', emoji: 'üîµ' },
              { id: '7-3', term: 'ÈªÉËâ≤', written: 'ÈªÉËâ≤', jyutping: 'wong4 sik1', eng: 'Yellow', urdu: 'Ÿæ€åŸÑÿß', viet: 'M√†u v√†ng', emoji: 'üü°' },
              { id: '7-4', term: 'Á∂†Ëâ≤', written: 'Á∂†Ëâ≤', jyutping: 'luk6 sik1', eng: 'Green', urdu: 'ÿ≥ÿ®ÿ≤', viet: 'M√†u xanh l√°', emoji: 'üü¢' },
              { id: '7-5', term: 'ÁôΩËâ≤', written: 'ÁôΩËâ≤', jyutping: 'baak6 sik1', eng: 'White', urdu: 'ÿ≥ŸÅ€åÿØ', viet: 'M√†u tr·∫Øng', emoji: '‚ö™' },
              { id: '7-6', term: 'ÈªëËâ≤', written: 'ÈªëËâ≤', jyutping: 'hak1 sik1', eng: 'Black', urdu: 'ÿ≥€åÿß€Å', viet: 'M√†u ƒëen', emoji: '‚ö´' },
              { id: '7-7', term: 'Ê©ôËâ≤', written: 'Ê©ôËâ≤', jyutping: 'caang2 sik1', eng: 'Orange', urdu: 'ŸÖÿßŸÑŸπÿß', viet: 'M√†u cam', emoji: 'üü†' },
              { id: '7-8', term: 'Á¥´Ëâ≤', written: 'Á¥´Ëâ≤', jyutping: 'zi2 sik1', eng: 'Purple', urdu: 'ÿ¨ÿßŸÖŸÜ€å', viet: 'M√†u t√≠m', emoji: 'üü£' },
              { id: '7-9', term: 'Á≤âÁ¥ÖËâ≤', written: 'Á≤âÁ¥ÖËâ≤', jyutping: 'fan2 hung4 sik1', eng: 'Pink', urdu: '⁄ØŸÑÿßÿ®€å', viet: 'M√†u h·ªìng', emoji: 'üå∏' },
            ]
          },
          {
            id: 'adjectives',
            title: 'ÂΩ¢ÂÆπË©û',
            titleEng: 'Adjectives',
            emoji: 'üìè',
            theme: 'bg-cyan-400',
            words: [
              { id: '8-1', term: 'Â§ß', written: 'Â§ß', jyutping: 'daai6', eng: 'Big', urdu: 'ÿ®⁄ëÿß', viet: 'To/L·ªõn', emoji: 'üêò' },
              { id: '8-2', term: 'Â∞è', written: 'Â∞è', jyutping: 'siu2', eng: 'Small', urdu: '⁄Ü⁄æŸàŸπÿß', viet: 'Nh·ªè/B√©', emoji: 'üêú' },
              { id: '8-3', term: 'Èï∑', written: 'Èï∑', jyutping: 'coeng4', eng: 'Long', urdu: 'ŸÑŸÖÿ®ÿß', viet: 'D√†i', emoji: 'ü¶í' },
              { id: '8-4', term: 'Áü≠', written: 'Áü≠', jyutping: 'dyun2', eng: 'Short', urdu: 'ŸÖÿÆÿ™ÿµÿ±', viet: 'Ng·∫Øn', emoji: 'üêõ' },
              { id: '8-5', term: 'Âø´', written: 'Âø´', jyutping: 'faai3', eng: 'Fast', urdu: 'ÿ™€åÿ≤', viet: 'Nhanh', emoji: 'üêÜ' },
              { id: '8-6', term: 'ÊÖ¢', written: 'ÊÖ¢', jyutping: 'maan6', eng: 'Slow', urdu: 'ÿ¢€Åÿ≥ÿ™€Å', viet: 'Ch·∫≠m', emoji: 'üê¢' },
              { id: '8-7', term: 'È´ò', written: 'È´ò', jyutping: 'gou1', eng: 'Tall', urdu: 'ŸÑŸÖÿ®ÿß', viet: 'Cao', emoji: 'ü¶í' },
              { id: '8-8', term: 'ÁüÆ', written: 'ÁüÆ', jyutping: 'ai2', eng: 'Short', urdu: '⁄Ü⁄æŸàŸπÿß', viet: 'Th·∫•p', emoji: 'üêï' },
            ]
          },
        ];

        // --- API Logic ---
        // Ê≥®ÊÑèÔºöÁÇ∫‰∫ÜÂÆâÂÖ®Ëµ∑Ë¶ãÔºåÂú® GitHub ‰∏äË´ãÂãøÁõ¥Êé•Á°¨Á∑®Á¢ºÊÇ®ÁöÑ API Key„ÄÇ
        // ÊÇ®ÂèØ‰ª•ÈÅ∏ÊìáÂú®Á®ãÂºè‰∏≠Âä†ÂÖ•‰∏ÄÂÄã prompt ‰æÜËÆì‰ΩøÁî®ËÄÖËº∏ÂÖ•ÔºåÊàñËÄÖ‰øùÊåÅÁ©∫Â≠ó‰∏≤„ÄÇ
        let apiKey = ""; 

        // AI ÈÄ†Âè•ÂáΩÊï∏
        const generateAISentence = async (word) => {
          if(!apiKey) {
             apiKey = prompt("Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑ Google Gemini API Key ‰ª•ÂïüÁî® AI ÂäüËÉΩ:", "");
             if(!apiKey) return null;
          }

          const promptText = `Please generate a simple sentence in Cantonese (Traditional Chinese) suitable for a primary school student using the word "${word}".
          Return ONLY a valid JSON object with this exact structure, no markdown formatting:
          {
            "cantonese": "The sentence in Traditional Chinese",
            "jyutping": "The jyutping pronunciation for the sentence",
            "english": "English translation of the sentence"
          }`;

          try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                contents: [{ parts: [{ text: promptText }] }],
                generationConfig: { responseMimeType: "application/json" }
              })
            });
            
            const data = await response.json();
            if (data.error) {
                console.error("API Error:", data.error);
                alert("API ÈåØË™§: " + data.error.message);
                return null;
            }
            const resultText = data.candidates?.[0]?.content?.parts?.[0]?.text;
            return JSON.parse(resultText);
          } catch (error) {
            console.error("AI Generation Error:", error);
            return null;
          }
        };

        // AI ÊïÖ‰∫ãÂáΩÊï∏
        const generateAIStory = async (category) => {
          if(!apiKey) {
             apiKey = prompt("Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑ Google Gemini API Key ‰ª•ÂïüÁî® AI ÂäüËÉΩ:", "");
             if(!apiKey) return null;
          }

          const promptText = `Please generate a very short, fun story (3-4 sentences) in Cantonese (Traditional Chinese) suitable for children using vocabulary related to the category "${category}".
          Return ONLY a valid JSON object with this exact structure, no markdown formatting:
          {
            "title": "A fun title in Cantonese",
            "cantonese": "The story content in Traditional Chinese",
            "jyutping": "The jyutping pronunciation for the story",
            "english": "English translation of the story"
          }`;

          try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                contents: [{ parts: [{ text: promptText }] }],
                generationConfig: { responseMimeType: "application/json" }
              })
            });
            
            const data = await response.json();
            if (data.error) {
                console.error("API Error:", data.error);
                alert("API ÈåØË™§: " + data.error.message);
                return null;
            }
            const resultText = data.candidates?.[0]?.content?.parts?.[0]?.text;
            return JSON.parse(resultText);
          } catch (error) {
            console.error("AI Generation Error:", error);
            return null;
          }
        };

        // --- ËºîÂä©ÂäüËÉΩ ---

        // Èü≥ÊïàÁîüÊàêÂô® (Web Audio API) - Áî®ÊñºÂèçÈ•ãÈü≥Êïà
        const playFeedbackSound = (type) => {
          const AudioContext = window.AudioContext || window.webkitAudioContext;
          if (!AudioContext) return;
          
          const ctx = new AudioContext();
          const now = ctx.currentTime;
          
          if (type === 'correct') {
            // ÊúâË∂£ÁöÑ„ÄåÂèÆÔºÅ„ÄçÊ≠£Á¢∫Èü≥Êïà
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(523.25, now);
            osc.frequency.linearRampToValueAtTime(1046.50, now + 0.1);
            
            gain.gain.setValueAtTime(0, now);
            gain.gain.linearRampToValueAtTime(0.3, now + 0.05);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.4);
            
            osc.start(now);
            osc.stop(now + 0.4);

            const osc2 = ctx.createOscillator();
            const gain2 = ctx.createGain();
            osc2.connect(gain2);
            gain2.connect(ctx.destination);
            osc2.type = 'sine';
            
            osc2.frequency.setValueAtTime(783.99, now);
            osc2.frequency.linearRampToValueAtTime(1567.98, now + 0.1);
            
            gain2.gain.setValueAtTime(0, now);
            gain2.gain.linearRampToValueAtTime(0.1, now + 0.05);
            gain2.gain.exponentialRampToValueAtTime(0.01, now + 0.4);
            
            osc2.start(now);
            osc2.stop(now + 0.4);

          } else {
            // ÊúâË∂£ÁöÑ„ÄåBwoop„ÄçÈåØË™§Èü≥Êïà
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(300, now);
            osc.frequency.exponentialRampToValueAtTime(50, now + 0.3);
            
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.linearRampToValueAtTime(0.01, now + 0.3);
            
            osc.start(now);
            osc.stop(now + 0.3);
          }
        };

        const speakCantonese = (text) => {
          if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.8; 
            const voices = window.speechSynthesis.getVoices();
            const cantoneseVoice = voices.find(v => v.lang.includes('HK') || v.lang.includes('yue'));
            if (cantoneseVoice) {
              utterance.voice = cantoneseVoice;
              utterance.lang = cantoneseVoice.lang;
            } else {
              utterance.lang = 'zh-HK';
            }
            window.speechSynthesis.speak(utterance);
          } else {
            alert("ÊÇ®ÁöÑÁÄèË¶ΩÂô®‰∏çÊîØÊåÅË™ûÈü≥ÂêàÊàêÂäüËÉΩ„ÄÇ");
          }
        };

        // --- ÂÖ±Áî® UI ÂÖÉ‰ª∂ ---

        const GameButton3D = ({ onClick, colorClass, children, className = "" }) => (
          <button 
            onClick={onClick}
            className={`${colorClass} ${className} relative text-white font-bold py-4 px-6 rounded-3xl border-b-8 border-opacity-30 border-black active:border-b-0 active:translate-y-2 transition-all transform hover:-translate-y-1 shadow-xl`}
          >
            {children}
          </button>
        );

        const IconButton = ({ onClick, icon: Icon, color, label }) => (
          <button 
            onClick={onClick}
            className={`flex flex-col items-center justify-center w-28 h-28 rounded-full shadow-[0_8px_0_rgba(0,0,0,0.15)] active:shadow-none active:translate-y-2 transition-all transform hover:scale-105 border-4 border-white ${color}`}
          >
            <Icon size={40} className="text-white drop-shadow-md" />
            <span className="text-white font-bold mt-1 text-sm drop-shadow-md">{label}</span>
          </button>
        );

        const BackgroundDecorations = () => (
          <div className="fixed inset-0 pointer-events-none overflow-hidden z-0 opacity-20">
            <div className="absolute top-10 left-10 text-9xl animate-pulse">‚òÅÔ∏è</div>
            <div className="absolute top-20 right-20 text-8xl animate-bounce-slow">üåü</div>
            <div className="absolute bottom-10 left-20 text-8xl animate-bounce">üéà</div>
            <div className="absolute bottom-40 right-10 text-9xl">üåà</div>
          </div>
        );

        // --- ÁµÑ‰ª∂ ---

        // ‰∏ªÁï´Èù¢
        const HomeScreen = ({ onNavigate }) => (
          <div className="relative flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-sky-300 to-indigo-200 p-4 overflow-hidden">
            <BackgroundDecorations />
            
            <div className="z-10 text-center space-y-6 mb-12">
              <div className="bg-white/30 backdrop-blur-md p-6 rounded-full border-4 border-white shadow-xl inline-block mb-4">
                <span className="text-8xl">üêº</span>
              </div>
              <h1 className="text-6xl md:text-7xl font-black text-white drop-shadow-[0_4px_4px_rgba(0,0,0,0.3)] tracking-wider stroke-text">
                Âª£Êù±Ë©±<br/>Ë∂£Âë≥Â≠∏Â†Ç
              </h1>
              <p className="text-2xl text-indigo-900 font-bold bg-white/50 inline-block px-6 py-2 rounded-full">
                Cantonese Fun Learning
              </p>
            </div>
            
            <div className="z-10 grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-4xl px-4">
              <GameButton3D 
                onClick={() => onNavigate('learning')} 
                colorClass="bg-gradient-to-br from-green-400 to-emerald-500"
                className="flex flex-col items-center justify-center py-10"
              >
                <div className="bg-white/20 p-6 rounded-full mb-4 animate-bounce-slow">
                  <BookOpen size={64} className="text-white" />
                </div>
                <h2 className="text-4xl font-black mb-2">Â≠∏ÁøíÂçÄ</h2>
                <p className="text-green-100 font-medium text-lg">Learning Zone</p>
              </GameButton3D>

              <GameButton3D 
                onClick={() => onNavigate('quiz')} 
                colorClass="bg-gradient-to-br from-orange-400 to-red-500"
                className="flex flex-col items-center justify-center py-10"
              >
                <div className="bg-white/20 p-6 rounded-full mb-4 animate-pulse">
                  <Brain size={64} className="text-white" />
                </div>
                <h2 className="text-4xl font-black mb-2">Ê∏¨Ë©¶ÂçÄ</h2>
                <p className="text-orange-100 font-medium text-lg">Quiz Zone</p>
              </GameButton3D>
            </div>
          </div>
        );

        // Â≠∏ÁøíÂçÄÔºö‰∏ªÈ°åÈÅ∏Êìá
        const CategoryList = ({ onSelectCategory, onBack }) => {
          const [aiStory, setAiStory] = useState(null);
          const [loadingStory, setLoadingStory] = useState(false);
          const [activeCategoryForStory, setActiveCategoryForStory] = useState(null);

          const handleGenerateStory = async (cat) => {
            setLoadingStory(true);
            setActiveCategoryForStory(cat.title);
            setAiStory(null);
            const story = await generateAIStory(cat.title);
            setAiStory(story);
            setLoadingStory(false);
          };

          return (
            <div className="min-h-screen bg-amber-50 p-6 relative">
              <div className="max-w-7xl mx-auto relative z-10">
                <div className="flex items-center mb-8">
                  <button onClick={onBack} className="bg-white text-amber-600 p-3 rounded-full shadow-lg border-4 border-amber-200 hover:scale-110 transition-transform">
                    <ArrowLeft size={32} strokeWidth={3} />
                  </button>
                  <h2 className="text-4xl md:text-5xl font-black text-amber-600 ml-6 tracking-wide text-shadow-sm">
                    ÈÅ∏ÊìáÂ≠∏Áøí‰∏ªÈ°å
                  </h2>
                </div>
                
                {/* AI Story Modal Overlay */}
                {loadingStory && (
                  <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                    <div className="bg-white p-8 rounded-[2rem] shadow-2xl text-center animate-bounce">
                      <Sparkles className="mx-auto text-yellow-400 mb-4 animate-spin" size={64} />
                      <h3 className="text-2xl font-bold text-gray-700">AI Ê≠£Âú®Ââµ‰Ωú {activeCategoryForStory} ÁöÑÊïÖ‰∫ã...</h3>
                    </div>
                  </div>
                )}

                {aiStory && (
                  <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fadeIn">
                    <div className="bg-white p-8 rounded-[2rem] shadow-2xl max-w-2xl w-full border-8 border-yellow-300 relative">
                       <button onClick={() => setAiStory(null)} className="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                         <XCircle size={32} />
                       </button>
                       <h3 className="text-3xl font-black text-orange-500 mb-2">‚ú® {aiStory.title}</h3>
                       <div className="bg-orange-50 p-6 rounded-2xl mb-4 text-left">
                         <p className="text-2xl font-bold text-gray-800 mb-2 leading-relaxed">{aiStory.cantonese}</p>
                         <p className="text-lg text-blue-500 font-mono mb-2">{aiStory.jyutping}</p>
                         <p className="text-lg text-gray-500 italic">{aiStory.english}</p>
                       </div>
                       <button onClick={() => speakCantonese(aiStory.cantonese)} className="bg-blue-400 hover:bg-blue-500 text-white px-6 py-3 rounded-full font-bold flex items-center justify-center mx-auto space-x-2">
                         <Volume2 /> <span>ÊúóËÆÄÊïÖ‰∫ã</span>
                       </button>
                    </div>
                  </div>
                )}
                
                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                  {vocabData.map((cat) => (
                    <div key={cat.id} className="relative group">
                      <button
                        onClick={() => onSelectCategory(cat)}
                        className={`${cat.theme} w-full relative rounded-[2rem] p-6 shadow-[0_8px_0_rgba(0,0,0,0.15)] active:shadow-none active:translate-y-2 hover:-translate-y-2 transition-all border-4 border-white flex flex-col items-center justify-between min-h-[220px]`}
                      >
                        <span className="text-7xl drop-shadow-md transform group-hover:scale-125 transition-transform duration-300">
                          {cat.emoji}
                        </span>
                        <div className="w-full bg-black/10 rounded-xl py-2 mt-4 backdrop-blur-sm">
                          <span className="text-2xl font-black text-white block text-center shadow-black drop-shadow-md">
                            {cat.title}
                          </span>
                          <span className="text-md font-bold text-white/90 block text-center mt-1">
                            {cat.titleEng}
                          </span>
                        </div>
                      </button>
                      {/* AI Story Button - Small Floating Button */}
                      <button 
                        onClick={(e) => { e.stopPropagation(); handleGenerateStory(cat); }}
                        className="absolute -top-2 -right-2 bg-white text-yellow-500 p-2 rounded-full shadow-lg border-2 border-yellow-200 hover:scale-110 transition-transform z-20"
                        title="AI Ë∂£Âë≥ÊïÖ‰∫ã"
                      >
                        <Sparkles size={24} fill="currentColor" />
                      </button>
                    </div>
                  ))}
                </div>
              </div>
              
              {/* ËÉåÊôØË£ùÈ£æ */}
              <div className="fixed bottom-0 left-0 w-full h-24 bg-repeat-x opacity-20" style={{backgroundImage: 'radial-gradient(circle, #f59e0b 20%, transparent 20%)', backgroundSize: '40px 40px'}}></div>
            </div>
          );
        };

        // Â≠∏ÁøíÂçÄÔºöÂñÆÂ≠óÂç°
        const WordCard = ({ word, onNext, onPrev, onBack, categoryColor }) => {
          const [isListening, setIsListening] = useState(false);
          const [feedback, setFeedback] = useState(null); 
          const recognitionRef = useRef(null);
          
          // AI Sentence State
          const [aiSentence, setAiSentence] = useState(null);
          const [loadingAi, setLoadingAi] = useState(false);

          const handleSpeak = () => speakCantonese(word.term);

          // Áï∂Â≠óË©ûÊîπËÆäÊôÇÔºåÂÅúÊ≠¢ÈåÑÈü≥‰∏¶ÈáçÁΩÆ AI ÁãÄÊÖã
          useEffect(() => {
            if (recognitionRef.current) {
              recognitionRef.current.onresult = null;
              recognitionRef.current.onend = null;
              recognitionRef.current.stop();
            }
            setIsListening(false);
            setFeedback(null);
            setAiSentence(null); // Reset AI sentence
            setLoadingAi(false);
          }, [word]);

          const handleGenerateSentence = async () => {
            setLoadingAi(true);
            const result = await generateAISentence(word.term);
            setAiSentence(result);
            setLoadingAi(false);
          };

          const handleListen = () => {
            if (!('webkitSpeechRecognition' in window)) {
              alert("Ë´ã‰ΩøÁî® Chrome ÁÄèË¶ΩÂô®");
              return;
            }

            if (recognitionRef.current) {
              recognitionRef.current.stop();
            }

            const recognition = new window.webkitSpeechRecognition();
            recognition.lang = 'zh-HK';
            recognition.continuous = false;
            recognition.interimResults = false;

            recognitionRef.current = recognition;

            recognition.onstart = () => {
              setIsListening(true);
              setFeedback(null);
            };

            recognition.onend = () => {
              setIsListening(false);
            };

            recognition.onresult = (event) => {
              const transcript = event.results[0][0].transcript;
              if (transcript.includes(word.term) || transcript.includes(word.written)) {
                setFeedback('correct');
              } else {
                setFeedback('incorrect');
              }
            };
            recognition.start();
          };

          return (
            <div className={`min-h-screen ${categoryColor} flex flex-col items-center justify-center p-4 transition-colors duration-500`}>
              <div className="w-full max-w-5xl mb-6 flex justify-between items-center z-10">
                <button onClick={onBack} className="bg-white/20 text-white p-3 rounded-full hover:bg-white/40 transition-colors backdrop-blur-md border-2 border-white/50">
                  <Home size={32} />
                </button>
                <div className="bg-white/20 px-6 py-2 rounded-full text-white font-bold backdrop-blur-md border-2 border-white/50">
                  Â≠∏ÁøíÊ®°Âºè
                </div>
              </div>

              <div className="relative bg-white rounded-[3rem] shadow-[0_12px_0_rgba(0,0,0,0.1)] p-8 w-full max-w-3xl text-center border-8 border-white">
                
                {/* Navigation Arrows */}
                <button onClick={onPrev} className="absolute -left-4 md:-left-16 top-1/2 transform -translate-y-1/2 p-4 bg-white rounded-full shadow-lg text-gray-400 hover:text-gray-800 hover:scale-110 transition-all border-4 border-gray-100">
                  <ArrowLeft size={32} strokeWidth={3} />
                </button>
                <button onClick={onNext} className="absolute -right-4 md:-right-16 top-1/2 transform -translate-y-1/2 p-4 bg-white rounded-full shadow-lg text-gray-400 hover:text-gray-800 hover:scale-110 transition-all rotate-180 border-4 border-gray-100">
                  <ArrowLeft size={32} strokeWidth={3} />
                </button>

                <div className="mb-4">
                  {/* ÂúñÁâáÊàñ Emoji È°ØÁ§∫ÂçÄ */}
                  {word.image ? (
                    <div className="mb-6">
                      <img 
                        src={word.image} 
                        alt={word.term} 
                        className="w-64 h-64 object-cover rounded-3xl mx-auto shadow-lg border-4 border-white" 
                      />
                    </div>
                  ) : (
                    <div className="inline-block p-8 bg-yellow-50 rounded-full mb-6 border-4 border-yellow-100 animate-bounce-slow">
                      <span className="text-9xl filter drop-shadow-md">{word.emoji}</span>
                    </div>
                  )}
                  
                  <h1 className="text-7xl md:text-8xl font-black text-gray-800 mb-4 tracking-tight">
                    {word.term}
                  </h1>
                  
                  <div className="inline-block bg-blue-100 px-6 py-2 rounded-2xl mb-8 transform -rotate-2">
                    <p className="text-3xl text-blue-600 font-mono font-bold tracking-wide">{word.jyutping}</p>
                  </div>
                  
                  {word.term !== word.written && (
                    <p className="text-xl text-gray-400 font-bold mb-6">Êõ∏Èù¢Ë™û: {word.written}</p>
                  )}

                  {/* AI Sentence Section */}
                  <div className="mb-6">
                    {!aiSentence && !loadingAi && (
                      <button 
                        onClick={handleGenerateSentence}
                        className="bg-gradient-to-r from-violet-500 to-fuchsia-500 text-white px-6 py-2 rounded-full font-bold shadow-md hover:scale-105 transition-transform flex items-center justify-center mx-auto space-x-2"
                      >
                        <Sparkles size={20} /> <span>AI ÈÄ†Âè•</span>
                      </button>
                    )}

                    {loadingAi && (
                      <div className="text-gray-400 font-bold animate-pulse flex justify-center items-center">
                        <Sparkles size={20} className="mr-2 animate-spin" /> AI Ê≠£Âú®ÊÄùËÄÉ‰∏≠...
                      </div>
                    )}

                    {aiSentence && (
                      <div className="bg-violet-50 border-2 border-violet-100 rounded-2xl p-4 text-left relative animate-fadeIn">
                        <div className="absolute -top-3 -right-3 bg-violet-500 text-white p-1 rounded-full shadow-sm">
                          <Sparkles size={16} fill="currentColor" />
                        </div>
                        <div className="flex justify-between items-start">
                          <div>
                            <p className="text-xl font-bold text-gray-800 mb-1">{aiSentence.cantonese}</p>
                            <p className="text-sm text-violet-500 font-mono mb-1">{aiSentence.jyutping}</p>
                            <p className="text-sm text-gray-500 italic">{aiSentence.english}</p>
                          </div>
                          <button onClick={() => speakCantonese(aiSentence.cantonese)} className="text-violet-500 hover:text-violet-700 p-2">
                            <Volume2 size={24} />
                          </button>
                        </div>
                      </div>
                    )}
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4 bg-gray-50 p-6 rounded-3xl border-4 border-gray-100">
                     <div className="bg-blue-50 p-3 rounded-2xl">
                       <span className="block text-xs text-blue-400 font-black uppercase tracking-wider mb-1">English</span>
                       <span className="text-xl font-bold text-blue-900">{word.eng}</span>
                     </div>
                     <div className="bg-green-50 p-3 rounded-2xl">
                       <span className="block text-xs text-green-400 font-black uppercase tracking-wider mb-1">Urdu</span>
                       <span className="text-xl font-bold text-green-900 font-urdu">{word.urdu}</span>
                     </div>
                     <div className="bg-pink-50 p-3 rounded-2xl">
                       <span className="block text-xs text-pink-400 font-black uppercase tracking-wider mb-1">Vietnamese</span>
                       <span className="text-xl font-bold text-pink-900">{word.viet}</span>
                     </div>
                  </div>
                </div>

                <div className="flex justify-center space-x-8">
                  <IconButton 
                    onClick={handleSpeak} 
                    icon={Volume2} 
                    color="bg-blue-400 hover:bg-blue-500" 
                    label="ËÅΩËÅΩÁúã" 
                  />
                  <IconButton 
                    onClick={handleListen} 
                    icon={Mic} 
                    color={`${isListening ? 'bg-red-500 animate-pulse' : 'bg-purple-400 hover:bg-purple-500'}`} 
                    label={isListening ? 'ËÅÜËÅΩ‰∏≠...' : 'ËÆÄËÆÄÁúã'} 
                  />
                </div>

                {/* AI Feedback Overlay */}
                {feedback && (
                  <div className="absolute inset-0 bg-white/90 rounded-[2.5rem] flex flex-col items-center justify-center z-20 animate-fadeIn backdrop-blur-sm">
                    {feedback === 'correct' ? (
                      <div className="text-center animate-bounce">
                        <div className="text-9xl mb-4">üåü</div>
                        <h3 className="text-4xl font-black text-green-500 mb-2">Â§™Ê£í‰∫ÜÔºÅ</h3>
                        <p className="text-gray-500 font-bold">ËÆÄÂæóÈùûÂ∏∏Ê®ôÊ∫ñÔºÅ</p>
                        <button onClick={() => setFeedback(null)} className="mt-8 bg-green-500 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:scale-105 transition-transform">
                          ÁπºÁ∫åÂ≠∏Áøí
                        </button>
                      </div>
                    ) : (
                      <div className="text-center">
                        <div className="text-8xl mb-4">üí™</div>
                        <h3 className="text-4xl font-black text-orange-500 mb-2">Âä†Ê≤πÔºÅ</h3>
                        <p className="text-gray-500 font-bold">ÂÜçË©¶‰∏ÄÊ¨°ÂêßÔºÅ</p>
                        <button onClick={() => setFeedback(null)} className="mt-8 bg-orange-400 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:scale-105 transition-transform">
                          ÂÜçË©¶‰∏ÄÊ¨°
                        </button>
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>
          );
        };

        // Ê∏¨Ë©¶ÂçÄÔºöÊ®°ÂºèÈÅ∏Êìá
        const QuizModeSelect = ({ onSelectMode, onBack }) => (
          <div className="min-h-screen bg-violet-100 flex flex-col items-center justify-center p-6 relative overflow-hidden">
            <div className="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none" style={{backgroundImage: 'radial-gradient(#8b5cf6 2px, transparent 2px)', backgroundSize: '30px 30px'}}></div>
            
            <button onClick={onBack} className="absolute top-6 left-6 bg-white p-3 rounded-full shadow-lg text-violet-600 border-4 border-violet-200 z-10">
              <Home size={32} strokeWidth={3} />
            </button>
            
            <div className="text-center mb-12 relative z-10">
              <span className="text-6xl mb-4 block animate-bounce">üéÆ</span>
              <h2 className="text-5xl font-black text-violet-800 drop-shadow-sm">ÈÅ∏ÊìáÈÅäÊà≤Ê®°Âºè</h2>
            </div>
            
            <div className="grid grid-cols-1 md:grid-cols-2 gap-10 w-full max-w-5xl px-4 z-10">
              <GameButton3D 
                onClick={() => onSelectMode('reading')} 
                colorClass="bg-cyan-500"
                className="flex flex-col items-center py-12"
              >
                <div className="bg-white/20 p-8 rounded-full mb-6 border-4 border-white/30">
                  <BookOpen size={64} className="text-white" />
                </div>
                <h3 className="text-3xl font-black">Èñ±ËÆÄÊåëÊà∞</h3>
                <p className="mt-2 text-cyan-100 font-bold opacity-90">ÁúãÊñáÂ≠óÔºåÈÅ∏Á≠îÊ°à</p>
              </GameButton3D>

              <GameButton3D 
                onClick={() => onSelectMode('listening')} 
                colorClass="bg-pink-500"
                className="flex flex-col items-center py-12"
              >
                <div className="bg-white/20 p-8 rounded-full mb-6 border-4 border-white/30">
                  <Music size={64} className="text-white" />
                </div>
                <h3 className="text-3xl font-black">ËÅΩÂäõÊåëÊà∞</h3>
                <p className="mt-2 text-pink-100 font-bold opacity-90">ËÅΩËÅ≤Èü≥ÔºåÈÅ∏Á≠îÊ°à</p>
              </GameButton3D>
            </div>
          </div>
        );

        // Ê∏¨Ë©¶ÂçÄÔºöÈÅäÊà≤Áï´Èù¢
        const QuizGame = ({ mode, onBack }) => {
          const [questions, setQuestions] = useState([]);
          const [currentQIndex, setCurrentQIndex] = useState(0);
          const [score, setScore] = useState(0);
          const [showResult, setShowResult] = useState(false);
          const [answered, setAnswered] = useState(false);
          const [selectedOption, setSelectedOption] = useState(null);

          useEffect(() => {
            const allWords = vocabData.flatMap(cat => cat.words);
            const shuffled = [...allWords].sort(() => 0.5 - Math.random());
            const selected = shuffled.slice(0, 10).map(word => {
              const distractors = allWords
                .filter(w => w.id !== word.id)
                .sort(() => 0.5 - Math.random())
                .slice(0, 3)
                .map(w => w.term);
              const options = [...distractors, word.term].sort(() => 0.5 - Math.random());
              return { ...word, options };
            });
            setQuestions(selected);
          }, []);

          const handleOptionClick = (option) => {
            if (answered) return;
            setSelectedOption(option);
            setAnswered(true);
            if (option === questions[currentQIndex].term) {
              setScore(s => s + 10);
              playFeedbackSound('correct'); // ‰øÆÊîπÔºöÊí≠ÊîæÊ≠£Á¢∫Èü≥Êïà
            } else {
              playFeedbackSound('incorrect'); // ‰øÆÊîπÔºöÊí≠ÊîæÈåØË™§Èü≥Êïà
            }
          };

          const handleNext = () => {
            if (currentQIndex < questions.length - 1) {
              setCurrentQIndex(c => c + 1);
              setAnswered(false);
              setSelectedOption(null);
            } else {
              setShowResult(true);
            }
          };

          if (questions.length === 0) return <div className="flex h-screen items-center justify-center text-3xl font-bold text-gray-500">Ê∫ñÂÇôÈÅäÊà≤‰∏≠...</div>;

          if (showResult) {
            return (
              <div className="min-h-screen bg-yellow-400 flex flex-col items-center justify-center p-6 relative overflow-hidden">
                <BackgroundDecorations />
                <div className="bg-white p-12 rounded-[3rem] shadow-[0_20px_0_rgba(0,0,0,0.1)] text-center max-w-xl w-full border-8 border-white relative z-10 animate-bounce-slow">
                  <div className="absolute -top-16 left-1/2 transform -translate-x-1/2">
                    <Trophy size={120} className="text-yellow-500 drop-shadow-lg fill-current" />
                  </div>
                  <h2 className="text-5xl font-black text-gray-800 mb-6 mt-12">ÊåëÊà∞ÂÆåÊàêÔºÅ</h2>
                  <div className="bg-gray-100 rounded-3xl p-8 mb-8">
                    <p className="text-2xl text-gray-500 mb-2 font-bold">‰Ω†ÁöÑÂæóÂàÜ</p>
                    <span className="text-8xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500">
                      {score}
                    </span>
                  </div>
                  <GameButton3D onClick={onBack} colorClass="bg-blue-500 w-full" className="text-2xl">
                    ËøîÂõû‰∏ªÈ†Å
                  </GameButton3D>
                </div>
              </div>
            );
          }

          const currentQ = questions[currentQIndex];

          return (
            <div className="min-h-screen bg-sky-200 flex flex-col items-center p-4">
              <div className="w-full max-w-4xl flex justify-between items-center mb-6 mt-4">
                <button onClick={onBack} className="bg-white/30 p-3 rounded-full hover:bg-white/50 text-white border-2 border-white/50">
                  <XCircle size={32} />
                </button>
                <div className="flex space-x-4">
                  <div className="bg-white/30 px-6 py-2 rounded-full text-white font-bold border-2 border-white/50 backdrop-blur-sm">
                    Á¨¨ {currentQIndex + 1} / {questions.length} È°å
                  </div>
                  <div className="bg-yellow-400 px-6 py-2 rounded-full text-yellow-900 font-bold border-b-4 border-yellow-600 shadow-lg">
                    ÂæóÂàÜ: {score}
                  </div>
                </div>
              </div>

              <div className="w-full max-w-3xl bg-white rounded-[2.5rem] shadow-[0_10px_0_rgba(0,0,0,0.1)] p-10 mb-8 text-center min-h-[320px] flex flex-col justify-center items-center border-4 border-white relative">
                {mode === 'reading' ? (
                  <>
                     {/* ‰øÆÊ≠£ÔºöÂú®Ê∏¨Ë©¶ÂçÄ‰πüÊîØÊè¥ÂúñÁâáÈ°ØÁ§∫ */}
                     {currentQ.image ? (
                       <div className="mb-6">
                         <img 
                           src={currentQ.image} 
                           alt={currentQ.term} 
                           className="w-48 h-48 object-cover rounded-3xl mx-auto shadow-md" 
                         />
                       </div>
                     ) : (
                       <div className="text-9xl mb-6 animate-bounce-slow">{currentQ.emoji}</div>
                     )}
                     
                     <p className="text-4xl text-gray-700 font-black mb-2">{currentQ.eng}</p>
                     <div className="flex space-x-4 text-xl text-gray-400 font-bold">
                       <span>{currentQ.urdu}</span>
                       <span>‚Ä¢</span>
                       <span>{currentQ.viet}</span>
                     </div>
                  </>
                ) : (
                  <>
                     <button 
                       onClick={() => speakCantonese(currentQ.term)}
                       className="bg-blue-400 hover:bg-blue-500 text-white rounded-full p-10 shadow-[0_10px_0_rgba(0,0,0,0.2)] active:shadow-none active:translate-y-2 transition-all"
                     >
                       <Volume2 size={80} />
                     </button>
                     <p className="mt-6 text-gray-400 font-bold text-xl">ÈªûÊìäÂñáÂè≠ËÅÜËÅΩËÆÄÈü≥</p>
                  </>
                )}
              </div>

              <div className="grid grid-cols-2 gap-6 w-full max-w-3xl">
                {currentQ.options.map((opt, idx) => {
                  let btnClass = "bg-white text-gray-600 border-b-8 border-gray-200 hover:-translate-y-1 hover:border-gray-300";
                  
                  if (answered) {
                    if (opt === currentQ.term) btnClass = "bg-green-400 text-white border-green-600 shadow-none translate-y-1"; 
                    else if (opt === selectedOption) btnClass = "bg-red-400 text-white border-red-600 opacity-50"; 
                    else btnClass = "bg-gray-100 text-gray-300 border-transparent opacity-50"; 
                  }

                  return (
                    <button 
                      key={idx} 
                      onClick={() => handleOptionClick(opt)}
                      disabled={answered}
                      className={`${btnClass} text-3xl font-black py-8 rounded-3xl shadow-lg transition-all duration-200 border-2 border-t-0 border-l-0 border-r-0`}
                    >
                      {opt}
                    </button>
                  );
                })}
              </div>

              {answered && (
                <div className="fixed bottom-8 w-full flex justify-center z-20">
                  <button 
                    onClick={handleNext}
                    className="bg-indigo-600 hover:bg-indigo-700 text-white text-2xl font-black px-16 py-5 rounded-full shadow-[0_10px_0_rgba(0,0,0,0.3)] hover:-translate-y-1 active:translate-y-2 active:shadow-none transition-all animate-bounce"
                  >
                    ‰∏ã‰∏ÄÈ°å ‚ûî
                  </button>
                </div>
              )}
            </div>
          );
        };

        // --- ‰∏ªÊáâÁî®Á®ãÂºèÂÖ•Âè£ ---

        function App() {
          const [view, setView] = useState('home'); 
          const [selectedCategory, setSelectedCategory] = useState(null);
          const [currentWordIndex, setCurrentWordIndex] = useState(0);
          const [quizMode, setQuizMode] = useState(null);

          const handleSelectCategory = (cat) => {
            setSelectedCategory(cat);
            setCurrentWordIndex(0);
            setView('learning-detail');
          };

          const handleWordNav = (direction) => {
            if (!selectedCategory) return;
            if (direction === 'next') {
              setCurrentWordIndex((prev) => (prev + 1) % selectedCategory.words.length);
            } else {
              setCurrentWordIndex((prev) => (prev - 1 + selectedCategory.words.length) % selectedCategory.words.length);
            }
          };

          const handleSelectQuizMode = (mode) => {
            setQuizMode(mode);
            setView('quiz-game');
          };

          return (
            <div className="font-sans antialiased text-gray-900 bg-gray-50 min-h-screen selection:bg-yellow-200 selection:text-yellow-900">
              {view === 'home' && <HomeScreen onNavigate={setView} />}
              
              {view === 'learning' && (
                <CategoryList 
                  onSelectCategory={handleSelectCategory} 
                  onBack={() => setView('home')} 
                />
              )}

              {view === 'learning-detail' && selectedCategory && (
                <WordCard 
                  word={selectedCategory.words[currentWordIndex]} 
                  categoryColor={selectedCategory.theme}
                  onNext={() => handleWordNav('next')}
                  onPrev={() => handleWordNav('prev')}
                  onBack={() => setView('learning')}
                />
              )}

              {view === 'quiz' && (
                <QuizModeSelect 
                  onSelectMode={handleSelectQuizMode}
                  onBack={() => setView('home')}
                />
              )}

              {view === 'quiz-game' && (
                <QuizGame 
                  mode={quizMode} 
                  onBack={() => setView('home')}
                />
              )}
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>